plot(catastroV["ESPECIE"])
#datos raster
#extraiga la resolucíon espacial (2formas)
evapo
res(evapo)
#extraiga la cantidad de pixeles/celdas
ncell(evapo)
#cantidad de columnas
ncol(evapo)
#cantidad de filas
nrow(evapo)
#sistema de referencias de coordenadas
crs(evapo)
#corte y enmascare el raster para la región de Valpariso
valparaiso<-divcomunal[divcomunal$NOM_REG=='Región de Valparaíso',]
et_valpo <- crop(evapo,valparaiso)
et_valpo <- mask(evapo,valparaiso)
et_valpo <- trim(et_valpo)
ext(et_valpo)
ext <- ext(c(0,410000,6.10e6,6.5e6))
et_valpo <- crop(et_valpo,ext)
et_valpo <- trim(et_valpo)
plot(et_valpo)
et_valpo[et_valpo > 32700] <- NA
#cree un mapa con plot para visualizar la variación de evapotranspiracion en la región de Valparaiso
plot(et_valpo)
#muestre con variación de colores las diferentes especies frutícolas de la región de Valpariso (vectorial)
library(tmap)
tm_shape(catastroV) +
tm_fill(col='ESPECIE',legend.show = FALSE)
#muestre los limites comunales de la región de Valparaiso
bordes <- st_crop(bordes,st_bbox(ext))
mapabordes <- tm_shape(bordes)+
tm_borders()
mapabordes
data <- read.csv2('data/data_mensual.csv')
data
data
data$comuna == 'Valparaiso'
data$comuna == 'Valparaíso'
data$comuna
data$region
library(sf)
st_geometry_type()
?st_geometry_type()
st_geometry()
library(terra)
x <- rast()
rast
x
ncell(x)
x <- rast(ncol=2,nrow=2)
x
values(x) <- 1:4
x
plot(x)
res(x)
res(x) < c(90,45)
res(x) <- c(90,45)
x
plot(x)
res(x) < c(90,45)
x
values(x) <- 1:4
x
x <- rast(ncol=2,nrow=2)
values(x) <- 1:4
plot(x)
ext(x)
ext(x)[1]
ext(x)[1]  <- 0
x
plot(x)
x <- rast(ncol=2,nrow=2)
values(x) <- c(1,1,1,1)
par(mfrow =c(1,2))
plot(x)
text(x)
x <- rast(ncol=2,nrow=2)
values(x) <- c(1,1,1,1)
x
plot(x)
text(x)
x <- rast(ncol=2,nrow=2)
values(x) <- c(1,1,1,1)
par(mfrow =c(1,2))
plot(x)
text(x)
par(mfrow =c(1,2))
par(mfrow =c(1,2))
plot(x)
x <- rast(ncol=2,nrow=2)
values(x) <- c(1,1,1,1)
plot(x)
text(x)
y <- aggregate(x,2)
plot(y)
text(y)
x <- rast(ncol=2,nrow=2)
values(x) <- c(1,1,1,1)
plot(x)
text(x)
y <- aggregate(x,2)
plot(y)
text(y)
plot(y)
text(y)
y
# cantidad de variables
nrow(cuencas)
cuencas <- read_sf('../data/cuencas_Chile/Cuencas_BNA.shp')
cuencas
nrow(cuencas)
ncol(cuencas)
prec <- rast('../data/CHELSA_pr_v2.1_20190101.tif')
library(terra)
prec <- rast('../data/CHELSA_pr_v2.1_20190101.tif')
prec
prec <- rast('../data/CHELSA_pr_v2.1_20190101.tif')
estaciones <- read_sf('../data/estaciones_chile/estaciones_chile.shp')
prec <- rast('../data/CHELSA_pr_v2.1_20190101.tif')
prec
crs(prec)
crs(prec)$epsg
crs(prec)
str(crs(prec))
EPSG(prec)
?epsg
??epsg
?st_crs(prec)
st_crs(prec)
st_crs(prec)$epsg
cuencas$NOM_CUEN == 'Río Limarí'
cuencas$NOM_CUEN == 'Río Limarí' |> any
cuencas$NOM_CUEN == 'Río Limarí' |> any()
cuencas$NOM_CUEN
cuencas$NOM_CUEN |> unique()
cuencas$NOM_CUEN |> unique() |> grepl('Limari')
cuencas$NOM_CUEN |> unique() |> grepl('Limarí')
?grepl
cuencas$NOM_CUEN |> unique() |> grepl(x='Limarí')
cuencas$NOM_CUEN |> unique() |> grepl(pattern ='Limarí')
cuencas$NOM_CUEN |> unique() |> grepl(pattern ='Limari')
cuencas$NOM_CUEN |> unique() |> grepl(pattern ='Limari') |> which()
cuencas$NOM_CUEN |> unique() |> grepl(pattern ='Limari') |> which() -> i
cuencas[i,]
cuencas$NOM_CUEN |> unique() |> grepl(pattern ='Elqui') |> which() -> i
i
cuencas[i,]
cuencas$NOM_CUEN
cuenca_limari <- cuencas[cuencas$NOM_CUEN == "Rio Limari",]
prec_limari <- crop(prec,cuenca_limari)
cuenca_limari <- cuencas[cuencas$NOM_CUEN == "Rio Limari",]
cuenca_limari
"Rio Limari"
cuenca_limari
#transforma SRC de vectorial a raster
cuenca_limari <- st_transform(cuenca_limari,st_crs(prec))
# hace el crop, mask y trim
prec_limari <- crop(prec,cuenca_limari)
prec_limari <- mask(prec_limari,cuenca_limari)
prec_limari <- trim(prec_limari,cuenca_limari)
prec_limari
plot(prec_limari)
st_crs(estaciones)
st_crs(prec)
st_crs(prec)
st_crs(estaciones)
#transforma SRC de vectorial a raster
cuenca_limari <- st_transform(cuenca_limari,st_crs(prec))
estaciones_cuenca <- st_intersection(estaciones,cuenca_limari)
st_crs(estaciones)
st_crs(cuenca_limari)
x
library(terra)
x <- rast()
x
setwd("/media/francisco/0A475C3F09F86BE3/PRODUCTOS/ROSA SOFRUCO")
library(terra)
im <- rast('OMROSA SOFRUCO 24-11-2022.tif')
plot(im)
plotRGB(im)
im2 <- terra::aggregate(im,5)
im2
res(im2)
plotRGB(im2)
nlyr(im2)
im2[[4]] <- NULL
im2 <- subst(im2,1:3)
im2 <- subst(im2,1,3)
im2
plot(im2)
plotRGB(im2)
writeRaster(im2,'~/Descargas/la_esperanza.tif')
im2 <- terra::aggregate(im2,5)
plotRGB(im2)
writeRaster(im2,'~/Descargas/la_esperanza2.tif')
res(im2)
plotRGB(im2)
plotRGB(im2)
library(tmap)
tmap_mode('view')
tm_shape(im2) + tm_raster()
tm_shape(im2) + tm_rgb()
im3 <- rast('~/Descargas/la_esperanza2.tif')
plotRGB(im3)
rc <- rast('OM RIO CLARO 24-11-2022.tif')
getwd()
ls()
lis.files()
list.files()
list.files()
setwd("/media/francisco/0A475C3F09F86BE3/PRODUCTOS/RIO CLARO")
rc <- rast('OM RIO CLARO 24-11-2022.tif')
rc2 <- aggregate(rc,10)
plotRGB(rc2)
rc2 <- subst(rc2,1,3)
writeRaster(rc2,'~/Descargas/rio_claro.tif')
res(im2)
res(rc2)
res(rc2)/res(im2)
1/res(rc2)/res(im2)
res(rc2)/res(im2)
1/.3946
rc2 <- aggregate(rc2,2.53)
writeRaster(rc2,'~/Descargas/rio_claro.tif')
writeRaster(rc2,'~/Descargas/rio_claro.tif',overwrite = TRUE)
res(rc2)
res(im2)
x <- c(1, 'a', 5)
class(x)
m <- matrix(1:20,ncol=4)
m
m[2:3,2:3]
month.name
days
df <- data.frame(meses = month.name,
n_caracteres =nchar(month.name),
)
df <- data.frame(meses = month.name,
n_caracteres =nchar(month.name)
)
df
iris
mtcars
datasets::data()
datasets()
dataset()
data
data("AirPassengers")
AirPassengers
?datasets
iris
?data
data()                         # list all available data sets
Titanic
USArrests
airquality
co""
co2
iris3
volcano
rast(volcano)
library(terra)
rast(volcano)
plot(rast(volcano))
trees
women
occupationalStatus
cars
UCBAdmissions
Nile
OrchardSprays
iris[sample(1:150,20),]
df[df$Species == 'setosa',]
df$Species
df
df <- iris[sample(1:150,20),]
df[df$Species == 'setosa',]
r <- rast(ncol=4,nrow=4,crs=4326)
r <- rast(ncol=4,nrow=4,crs="EPSG:4326")
r
r <- rast(ncol=4,nrow=4,crs="EPSG:4326")
getd()
getwd()
read_sf('Evaluaciones/data/estaciones_chile')
library(sf)
read_sf('Evaluaciones/data/estaciones_chile')
estas <- read_sf('Evaluaciones/data/estaciones_chile')
estas
names(estas)
estas$region
estas$region
estas
estas$region
|> unique()
estas$region |> unique()
cuenca_limari <- read_sf('Evaluaciones/data/cuenca_limari.shp')
cuenca_limari
estas
st_intersection(estas,cuenca_limari)
st_crs(cuenca_limari)
st_crs(cuenca_limari)$epsg
st_crs(cuenca_limari)
st_crs(estas)
st_crs(cuenca_limari)
cuenca_limari <- st_transform(cuenca_limari,st_crs(estas))
cuenca_limari
st_intersection(estas,cuenca_limari)
estas_limari <-st_intersection(estas,cuenca_limari)
estas_limari
df_estas_limari <- st_drop_geometry(estas_limari)
names(df_estas_limari)
df_estas_limari <- df_estas_limari[,1:4]
df_estas_limari
estas <- read_sf('Evaluaciones/data/estaciones_chile')
df_estas <- st_drop_geometry(estas)
df_estas
df_estas <- df_estas[,1:4]
df_estas
write_csv2(df_estas,'Evaluaciones/data/data_estaciones.csv')
write.csv2(df_estas,'Evaluaciones/data/data_estaciones.csv')
df_estaciones <- read.csv2('../data/data_estaciones.csv')
df_estaciones
df_estaciones
sf_estaciones <- st_as_sf(df_estaciones,coords = c('longitud','latitud'),crs =4326)
estas <- read_sf('Evaluaciones/data/estaciones_chile')
library(dplyr)
drop_na(estas)
library(tidyr)
drop_na(estas)
estas <- drop_na(estas)
df_estas <- st_drop_geometry(estas)
df_estas <- df_estas[,1:4]
write.csv2(df_estas,'Evaluaciones/data/data_estaciones.csv')
df_estaciones <- read.csv2('../data/data_estaciones.csv')
sf_estaciones <- st_as_sf(df_estaciones,coords = c('longitud','latitud'),crs =4326)
sf_estaciones
cuencas <- read_sf('../data/cuencas_Chile')
cuencas
cuencas$NOM_CUEN
cuencas$NOM_CUEN |> unique()
cuencas
st_crs(cuencas)
estas
cuencas[cuencas$NOM_CUEN == 'Rio Imperial',]
estas_imperial <- st_intersection(estas,cuenca_imperial)
cuenca_imperial <- cuencas[cuencas$NOM_CUEN == 'Rio Imperial',]
estas_imperial <- st_intersection(estas,cuenca_imperial)
cuencas <- read_sf('../data/cuencas_Chile')
cuencas <- st_transform(cuencas,st_crs(estas))
cuenca_imperial <- cuencas[cuencas$NOM_CUEN == 'Rio Imperial',]
estas_imperial <- st_intersection(estas,cuenca_imperial)
estas_imperial
plot(estas_imperial$geometry)
dem_imperial <- get_elev_raster(cuenca_imperial,z = 9)
library(elevatr)
dem_imperial <- get_elev_raster(cuenca_imperial,z = 9)
library(elevatr)
dem_imperial <- get_elev_raster(cuenca_imperial,z = 9)
install.packages('rgdal')
library(elevatr)
dem_imperial <- get_elev_raster(cuenca_imperial,z = 9)
elev_dem <- extract(dem,estas_imperial)
library(elevatr)
plot(dem_imperial)
dem_imperial <- get_elev_raster(cuenca_imperial,z = 9)
?tm_grid
library(tmap)
tm_grid
?tm_grid
iris
df['Petal.Length']
iris['Petal.Length']
library(terra)
library(sf)
library(tmap)
library(elevatr)
library(rgdal)
library(terra)
library(sf)
library(tmap)
library(elevatr)
library(rgdal)
df_estaciones <- read_sf("data_estaciones.csv")
df_estaciones <- read.csv2("data_estaciones.csv")
setwd("~/OneDrive/UMayor/Escuelas/MedioAmbiente/2022/2do_semestre/IMSE1017/Evaluaciones/Examen")
library(terra)
library(sf)
library(tmap)
library(elevatr)
library(rgdal)
df_estaciones <- read_sf("data_estaciones.csv")
df_estaciones <- read.csv2("data_estaciones.csv")
df_estaciones
sf_estaciones <- st_as_sf(df_estaciones,coords = c("latitud","longitud","altitud"))
sf_estaciones
plot(sf_estaciones$geometry)
cuenca_Imperial <- st_transform(cuenca_Imperial,4326)
head(df_estaciones)
sf_estaciones <- st_set_crs(sf_estaciones,4326)
cuenca <- read_sf('cuencas_Chile/Cuencas_BNA.shp')
cuenca_Imperial <- cuenca[cuenca$NOM_CUEN == "Rio Imperial",]
cuenca_Imperial
plot(cuenca_Imperial$geometry)
sf_estaciones <- st_transform(sf_estaciones,st_crs(cuenca_Imperial))
estaciones_cuenca <- st_intersection(sf_estaciones,cuenca_Imperial)
estaciones_cuenca
estaciones_cuenca |> nrow()
estaciones_cuenca |> ncol()
library(elevatr)
library(progress)
dem <- get_elev_raster(cuenca_Imperial,z=9)
cuenca_Imperial
dem <- get_elev_raster(cuenca_Imperial,z=9)
cuenca_Imperial
dem_imperial <- get_elev_raster(cuenca_Imperial,z=9)
dem_imperial1 <- trim(mask(dem_imperial,cuenca_Imperial))
dem_imperial1 <- rast(dem_imperial1)
slope = terrain(dem_imperial1, v='slope',unit = 'radians')
aspect = terrain(dem_imperial1, v='aspect',unit = 'radians')
hill = shade(slope, aspect)
library(tmap)
tmap mode set to plotting
mapa <- tm_shape(hill) +
tm_raster(style = 'cont',palette = grey(0:100/100),legend.show = FALSE) +
tm_shape(dem_imperial1) +
tm_raster(title= 'Elevación (m)', style ='cont',palette = rev(topo.colors(20)),alpha = .4) +
tm_graticules(lwd = .4,alpha = .6) +
tm_compass(position = c('right','top'))
mapa2 <- tm_shape(cuenca_Imperial) +
tm_borders() +
tm_shape(estaciones_cuenca,size=3) +
tm_dots()
mapa <- mapa+mapa2
tmap_mode('view')
plot(mapa)
dem <- get_elev_raster(cuenca_Imperial,z=9)
cuenca_Imperial
sf_estaciones
library(sf)
library(terra)
library(raster)
library(progress)
library(rgdal)
library(elevatr)
library(tmap)
#lea el archivo y asignelo a al obejto df_estaciones
df_estaciones<-read.csv2('data_estaciones.csv')
#convierte el objeto df_estaciones en un objeto sf y asignele coordenadas geograficas asignelo al objeto sf_estaciones(profe lo asignare a sf_estaciones1)
sf_estaciones1<-st_as_sf(df_estaciones)
st_as_sf(objeto,coords=c("longitud","latitud",))
cuencas<-read_sf('cuencas_Chile')
cuencas2<-st_transform(cuencas,4326)
cuencaRI<-cuencas2[cuencas2$NOM_CUEN=='rio Imperial']
intersec<-st_intersection(sf_estaciones,cuencaRI)
estaciones<-Intersec
plot(st_geometry(cuencaRI))
plot(estaciones$geometry,add=TRUE)
#4 utilice el paquete elevart y asignelo al objeto dem_imperial
dem_imperial<-get_elev_raster(cuencaRI,z=10)
dem_imperial<-rast(dem_imperial)
#6 cree un mapa de sombras
#primero hareos una mascara del dem eliminando los espacios en blanco
na.omit(cuencaRI)
maskRI<-mask(dem,cuencaRI)
plot(maskRI)
RI<-trim(maskRI)
plot(RI)
#para crear el mapa partimos por crear un raster de aspecto y slope utilizando las funciones terrain y shade
slope=terrain(RI,v='slope',unit='radians')
aspect=terrain(RI,v='aspect',unit='radians')
hill=shade(slope,aspect)
plot(hill)
#utilizamos tmap
tmap_mode('plot')
mapa<-tm-shape(hill)+tm_raster(style='cont',palette=grey(0:100/100),legend.show=FALSE)+tm_shape(dem_imperial)+tm_raster(title = 'Elevacion(m)',style='cont',palette = rev(topo.colors(20)),alpha=.6)+tm_compass(position=c('ringht','top'))mapa
#agregar limites de la cuenca y estaciones(mapa de los bordes de la cuenca)
bordes<-st_union(cuencaRI$geometry)
mapabordes<-tm_shape(bordes)+tm_borders(lw=4)
mapabordes
#agregar al mapa las estaciones que corresponden
mapaestaciones<-mapabordes+tm_shape(estaciones)+tm_dots
mapaestaciones
#unir el mapa del punto anterior con el de los limites de la cuenca y las estaciones
mapa3RI<-mapabordes+mapaestaciones
mapa3RI
#7 cree un mapa estatico con tmap. debe contener leyenda....
tmap_mode("plot")
mapa3RI
library(sf)
library(terra)
library(raster)
library(tmap)
library(elevatr)
#Lea el archivo en R y asígnelo al objeto df_estaciones
df_estaciones <- read.csv2("data_estaciones.csv")
df_estaciones
sf_estaciones <- st_as_sf(df_estaciones)
sf_estaciones<-st_transform(sf_estaciones, 4326)
#Utilice el archivoCuencas_BNA y seleccione las estaciones que se encuentran en la cuenca del río Imperial.
Cuencas_BNA<- read_sf('cuencas_Chile')
cuencas_ri <- Cuencas_BNA[Cuencas_BNA$NOM_CUEN == 'Rio Imperial',]
int <- st_intersection(sf_estaciones, cuencas_ri)
sf_estaciones <- st_as_sf(df_estaciones,coords = c('longitud','latitud'),crs=4326)
sf_estaciones
#Utilice el archivoCuencas_BNA y seleccione las estaciones que se encuentran en la cuenca del río Imperial.
Cuencas_BNA<- read_sf('cuencas_Chile')
cuencas_ri <- Cuencas_BNA[Cuencas_BNA$NOM_CUEN == 'Rio Imperial',]
int <- st_intersection(sf_estaciones, cuencas_ri)
#Utilice el paquete {elevatr} para descargar datos de elevación para la cuenca del río Imperial. Asignelo al objeto dem_imperial.
dem_imperial <- get_elev_raster(cuencas_ri)
